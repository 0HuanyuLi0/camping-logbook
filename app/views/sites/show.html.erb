

<h2><%= @site.name %></h2>

<% if @current_user.present? %>
    <%= link_to "Edit", edit_site_path(@site) %>

    <% if @current_user.name == "admin" %>
    |
    <%= link_to "Delete", site_path(@site.id), method:'delete' %>
    <br>

    <% end %>
<% end %>

<br>

<div class="site_info">
    <strong>Name:</strong>
    <p><%= @site.name %></p>
</div>

<div class="site_info">
    <strong>Location:</strong>
    <p><%= @site.location %></p>
</div>

<div class="site_info">
    <strong>Coordinates:</strong>
    <p><%= @site.coordinates %></p>
</div>

<div class="site_info">
    <strong>Price:</strong>
    <p><%= @site.price == 0 ? 'FREE' : "$ #{@site.price}" %></p>
</div>

<div class="site_info">
    <strong>Link:</strong>
    <p> <%= link_to @site.link, @site.link %></p>
</div>

<div class="site_info">
    <strong>Powered Site:</strong>
    <p><%= @site.powered ? 'Yes' : 'No' %></p>
</div>

<div class="site_info">
    <strong>Pets Allowed:</strong>
    <p><%= @site.pets ? 'Yes' : 'No' %></p>
</div>

<div class="site_info">
    <strong>Description:</strong>
    <p><%= @site.description %></p>
</div>


<% if @site.photos.present? %>

    <div class="site_info">
        <strong>Photos:</strong>
        <ul>
            <% @site.photos.each do |photo|%>
                
             
                <% if photo.isPublic %>
              
                <li><%= image_tag photo.link, alt:photo.name, class:"site_photo"%></li>

                <% end %>
            <% end %>
        </ul>
    </div>
<% end %>


<% if @site.reviews.present? %>
<hr>
    <div class="site_info">
        <strong>Reviews:</strong>
        <ul>
            <% @site.reviews.each do |review|%>
                <li>
                By: <%= review.user.name %>
                <br>
                <em>
                on: <%= review.updated_at.strftime("%D") %>
                
                </em>
                <br>
                Score: <%= review.score %>
                <br>
                Comment: <%= review.comment %>
                </li>
            <% end %>
        </ul>
    </div>

<% end %>

<hr>
<h3>Post New Review</h3>

    <% if !@current_user.present? %>
        <strong style="color:red">Please Login to post the review, and add your private photos and story </strong>
    <% end %>

<%= form_with model:@reviews, local: true do |f| %>

    <%= hidden_field_tag "site_id", @site.id %>

    <%= f.label :score %>
    <br>
    <%= f.number_field :score , in: 0.5..5, step:0.5, disabled: !@current_user.present?%>
    <br><br>

    <%= f.label :comment %>
    <br>
    <%= f.text_area :comment,disabled: !@current_user.present? %>
    <br><br>

    <%= f.submit disabled: !@current_user.present? %>
<% end %>

<% if @current_user.present? %>
    <hr>
    Your Private Photos:
    <ul>
        <% @site.photos.each do |photo| %>

            <% if photo.user_id == @current_user.id %>
                <li>
                    <%= image_tag photo.link, alt:photo.name, class:"site_photo"%>
                    <%= link_to "Delete", photo_path(photo.id), method:"delete" %>
                </li>
            <% end %>

        <% end%>
    </ul>

    <%= form_with model:@photo, local: true do |f| %>

        <%= hidden_field_tag "site_id", @site.id %>

        <%= f.label :link, "Photo Link"%>
        <br>
        <%= f.text_field :link %>
        <br><br>
        <%= f.submit %>

    <% end %>

<% end %>





